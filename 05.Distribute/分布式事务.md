<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [分布式事务](#分布式事务)
    - [本地消息表](#本地消息表)
    - [消息事务](#消息事务)
    - [两阶段提交](#两阶段提交)
    - [TCC](#tcc)
    - [最大努力通知](#最大努力通知)
    - [Seata](#seata)
- [阅读](#阅读)

<!-- /TOC -->
</details>


## 分布式事务


### 本地消息表




### 消息事务

基于消息中间件的两阶段提交,将分布式事务拆分成本地事务进行处理.

以转账为例,事务1扣钱成功,同时发出消息,通知事务2加钱.

具体的实现可分为两种:本地消息表与事务消息

![](https://gitee.com/LuVx/img/raw/master/xa_mq.png)

事务消息方式:
1. 事务A发送事务执行预备消息
2. 收到MQ回复后执行事务
3. 根据执行的结果决定提交还是回滚消息

![](https://gitee.com/LuVx/img/raw/master/xa_mq1.png)
图源见水印,侵删

### 两阶段提交

Two-phase Commit, 2PC

准备阶段:协调者确认所有事务参与者是否可以提交

提交阶段:所有参与者全部回复可以,协调者协调参与者提交事务

### TCC

Try,Commit,Cancel



存在的问题:

* 参与者阻塞: 参与者响应协调者时,其他参与者处于等待状态
* 协调者太过重要: 协调者一旦故障,整个结构将不可用
* 数据一致性: 部分参与者提交时发生故障,导致数据一致性问题
* 保守: 一个参与者的事务失败,所有参与者的事务全部回滚

### 最大努力通知



### Seata




## 阅读

1. [聊聊分布式事务, 再说说解决方案](https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html)
