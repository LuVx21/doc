---
title: Linux Command02
date: 2017-08-01
tags:
- Linux
- Shell
---
<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [运维](#运维)
  - [lsof](#lsof)
  - [ps](#ps)
  - [netstat](#netstat)
  - [du](#du)
  - [df](#df)
  - [iptables](#iptables)
- [执行相关](#执行相关)
  - [xargs](#xargs)
  - [screen](#screen)
  - [at](#at)
  - [watch](#watch)
  - [nohup](#nohup)
- [传输](#传输)
  - [scp](#scp)
  - [sftp](#sftp)
  - [paste](#paste)
  - [\>/\>\>](#)
  - [分屏显示:more](#分屏显示more)
  - [管道:|](#管道)

<!-- /TOC -->
</details>

# 运维

## lsof

Linux中文件夹也是文件的一种, 网络连接, 硬件等也是文件
`lsof`列出当前系统打开的文件
查看进程和文件的占用关系

| 参数 | 说明                         |
| :--- | :--------------------------- |
| -c   | 显示进程打开的文件           |
| -p   | 显示某进程号的进程打开的文件 |
| -i   | `*1`,lsof -i:80 查看端口     |


> `*1`:[46][TCP|UDP][@hostname|hostaddr][:service|port] 显示符合条件的进程情况


```
该命令的作用类似于netstat -anp | grep 5000, 可以根据端口号, 查看是哪个进程占用了5000端口.
lsof -i:5000
```

## ps

在Linux系统中显示进程的状态

| 参数 | 说明                           |
| :--- | :----------------------------- |
| -a   | 显示所有用户的进程             |
| -x   | 显示没有控制终端的进程         |
| -u   | 按照用户名称查询进程           |
| -f   | 列出全部信息, 常和其它选项联用 |
| -j   | 用任务格式来显示进程           |
| -e   | 显示所有进程                   |

```
ps aux
ps -ef
```

## netstat

输出linux系统的网络信息


| 参数 | 说明                                |
| :--- | :---------------------------------- |
| -a   | 显示所有socket连接                  |
| -l   | 显示监控中(listening)的socket连接   |
| -n   | 直接使用ip地址, 而不使用域名服务器  |
| -p   | 显示正在使用socket的程序的pid和名称 |
| -r   | 打印路由表                          |
| -t   | 显示TCP传输协议的连线状况           |
| -u   | 显示UDP传输协议的连线状况           |
| -s   | 显示网络工作信息统计表              |

```
# mac下无效!?
netstat -anp
```

> 如何查看占用某个端口的程序的pid?
> `netstat -anp`

## du

查看文件和文件夹的磁盘占用情况

| 参数 | 说明               |
| :--- | :----------------- |
| -h   | 易读方式显示       |
| -d   | 最大的查询层次     |
| -a   | 显示所有文件的大小 |
| -s   |                    |

```
du -a
du -h *
```

## df

```
df -ah
```
## iptables

关于

格式

```shell
iptables -t 表名 <-A/I/D/R> 规则链名 [规则号] <-i/o 网卡名> -p 协议名 <-s 源IP/源子网> --sport 源端口 <-d 目标IP/目标子网> --dport 目标端口 -j 动作
```

参数:

| 参数 | 说明                       |
| :--- | :------------------------- |
| -t   | 指定要操纵的表             |
| -A   | 向规则链中添加条目         |
| -D   | 从规则链中删除条目         |
| -I   | 向规则链中插入条目         |
| -R   | 替换规则链中的条目         |
| -p   | 指定要匹配的数据包协议类型 |

```shell
# 开放8080端口
iptables -I INPUT -p tcp --dport 8080 -j ACCEPT;iptables save
```

# 执行相关

## xargs

```shell
# 删除回车(Windows下换行符变为linux下的)
find test/  -name "*.*" | xargs sed -i 's/\r//g
```

## screen

## at

## watch

## nohup

后台运行命令

```shell
nohup java -jar xx.jar > out.file 2>&1 &
```

# 传输

## scp

```shell
# 上传
scp 本地文件地址 云服务器登录名@云服务器公网IP/域名:云服务器文件地址
# 下载
scp 云服务器登录名@云服务器公网IP/域名:云服务器文件地址 本地文件地址
```

## sftp

```
sftp root@192.168.0.1
sftp> get <file> <path>
sftp> put <file> <path>
```

## paste
关于

文本文件或标准输出中的内容粘贴到新的文件

格式

	paste [option] xx1.xx xx2.xx
参数

| 参数 | 说明                                      |
| :--- | :---------------------------------------- |
| -d   | 默认域分隔符是空格或Tab, 设置新的域分隔符 |
| -s   | 将每个文件粘贴成一行                      |
| -    | 从标准输入中读取数据                      |

```
# 同行合并, 以, 分隔(默认以tab分割)
paste 1.txt 2.txt -d ", "
```

## >/>>

Linux允许将命令执行结果重定向到一个文件,
将本应显示在终端上的内容保存到指定文件中.

注意

* `>`输出重定向会覆盖原来的内容
* `>>`输出重定向则会追加到文件的尾部

## 分屏显示:more

查看内容时, 在信息过长无法在一屏上显示时, 会出现快速滚屏, 使得用户无法看清文件的内容, 此时可以使用more命令, 每次只显示一页, 按下空格键可以显示下一页, 按下q键退出显示, 按下h键可以获取帮助.
ctrl+b 返回上一屏
ctrl+f 下一屏

> 与此类似的有`less`命令

## 管道:|

一个命令的输出可以通过管道做为另一个命令的输入
`|`的左右分为两端, 左端获得命令执行结果, 右端使用左端结果
