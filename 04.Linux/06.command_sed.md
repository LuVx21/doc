---
title: sed
date: 2017-09-01
tags:
- Linux
- Shell
---
<details>
<summary>点击展开目录</summary>

- [关于](#关于)
- [使用例](#使用例)
  - [新增](#新增)
  - [插入](#插入)
- [场景](#场景)
- [参考](#参考)


</details>

# 关于

本身是一个管道命令, 主要是以行为单位进行处理, 可以将数据行进行替换, 删除, 新增, 选取等特定工作

__格式__

```shell
	sed [option] 'script' <filename>
```

__参数__

| 参数 | 说明                                                                           |
| :--- | :----------------------------------------------------------------------------- |
| -n   | 使用安静(silent)模式.只有经过sed 特殊处理的那一行(或者动作)才会被列出来.       |
| -e   | 直接在指令列模式上进行 sed 的动作编辑;                                         |
| -f   | 直接将 sed 的动作写在一个档案内, -f filename 则可以执行 filename 内的sed 动作; |
| -r   | sed 的动作支援的是延伸型正规表示法的语法.(预设是基础正规表示法语法)            |
| -i   | 直接修改读取的档案内容, 而不是由屏幕输出                                       |


# 使用例

__操作指令__

| 命令 | 说明                                                               |
| :--- | :----------------------------------------------------------------- |
| a    | 新增, a 的后面可以接字串, 而这些字串会在新的一行出现(目前的下一行) |
| c    | 替换, 行                                                           |
| d    | 删除                                                               |
| i    | 插入, i 的后面可以接字串, 而这些字串会在新的一行出现(目前的上一行) |
| p    | 列印, 将某个选择的资料印出.通常 p 会与参数 sed -n 一起             |
| s    | 替换, 字符                                                         |


## 新增

```shell
# 在第一行后加内容
sed '1a this is added' <filename>
# 在第1~3行后加内容
sed '1, 3a this is added' <filename>
# '\n', 添加多行
sed '1a this is add' <filename>
# 每行后添加空行
sed 'G' <filename>
```

## 插入

```shell
# 每行前3个字符后插入'@'
sed 's/^.\{3\}/&\@/g' <filename>
```

# 场景

提交文件前替换内容
```shell
for file in $(git diff --cached --name-only); do
  echo $file replace
  sed -i "" \
  -e 's/pattern/replace_text/g' \
  $file
  # 删除行位空白
  sed -i "" 's/[ ]*$//g' $file
done
```

# 参考

[sed命令详解](http://8598676.blog.51cto.com/8588676/1398213)
