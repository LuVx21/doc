<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [关于](#关于)
- [特点](#特点)
- [应用场景](#应用场景)
- [组件](#组件)

<!-- /TOC -->
</details>

## 关于

一款分布式流处理框架, 用于构建实时流处理应用

基于TCP协议通信, 在大数据领域的实时计算以及日志采集方面被大规模使用(主要用于处理活跃的流式数据)

它有一个核心的功能广为人知, 即作为企业级的消息引擎被广泛使用

分布式消息系统:

* 利用高效可靠的消息传递机制进行平台无关的数据交流
* 基于数据通信来进行分布式系统的集成
* 通过提供消息传递和消息排队模型, 可以在分布式环境下扩展进程间的通信

Kafka 一路发展到现在, 已经由最初的`分布式提交日志系统`逐渐演变成了`实时流处理框架`.

## 特点

* 支持持久化操作
* 分布式系统, 易扩展
* 支持online, offline场景(离线数据处理和实时数据处理)
* zero-copy: 减少IO操作步骤
* 磁盘顺序读写, 存取代价为`O(1)`, 一般采取BTree存储则是`O(lgn)`
* 数据压缩, 数据批量发送
* Topic划分为多个partition, 提高parallelism
* 同时为发布, 订阅提供高吞吐量
* 支持消息副本, 高容错性

优点:

1. 数据冗余: 存储, 持久化, 备用
2. 扩展性: 解耦了逻辑过程, 使扩展变得容易, 在逻辑链路上增加处理流程即可, 可以做到不对现有代码进行修改
3. 高可用性: 系统的某个模块出现异常, 不会影响整体, 进入队列的消息在恢复后可以被继续处理
4. 有序: 分区内部能够保证有序
5. 异步通信: kafka 支持异步生产

高吞吐量的实现保证:

1. 顺序读写: Partition 中的消息顺序读写的. 顺序读写要快于随机读写.
2. zero-copy(零拷贝): 生产者, 消费者对于 Kafka 中的消息是采用零拷贝实现的.
3. 批量发送: 允许批量发送模式
4. 消息压缩: 允许对消息集合进行压缩

## 应用场景

* 解耦: 基于数据的传递, 可以将复杂的逻辑解耦, 以消息联通
* 日志收集: 通过 kafka 进入日志系统, 后续使用
* 流处理: 流式数据存储
* 限流削峰: 请求高峰期, 将请求放入 kafka 进行排队, 然后依次提供服务
* 行为跟踪
* 消息队列

## 组件

| 组成          | 说明                                                         |
| :------------ | :----------------------------------------------------------- |
| Broker        | 缓存代理, Kafka集群中的一台或多台服务器的统称, 负责各类RPC请求的处理以及消息的持久化 |
| Topic         | 消息源的不同分类, 逻辑概念, 生产者发送的每条消息都会被发送到某个主题上 |
| Partition     | 一个topic可分为多个partition, 每个partition是一个队列, 物理概念, 每个partition对应一个目录 |
| Segment       | partition物理上由多个segment组成                             |
| Message       | 消息, 通信的基本单位, 不在内存中缓存, 而是持久化, 充分利用磁盘的顺序读写性能, 由一个键, 一个值和一个时间戳组成 |
| Producer      | 向topic发布消息                                              |
| Consumer      | 订阅topic并处理其发布的消息                                  |
| ConsumerGroup | 消费组                                                       |

![kafka消息流程](https://gitee.com/LuVx/img/raw/master/kafka/kafka_msg.png)

